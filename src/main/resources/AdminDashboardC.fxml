<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import de.jensd.fx.glyphs.fontawesome.FontAwesomeIconView?>
<?import javafx.scene.chart.*?>

<VBox xmlns="http://javafx.com/javafx" xmlns:fx="http://javafx.com/fxml"
      fx:controller="controllers.AdminDashboardCController"
      styleClass="root"
      stylesheets="@css/dashboard.css"
      prefWidth="1200" prefHeight="800">

    <!-- Header avec fond dÃ©gradÃ© et icÃ´nes -->
    <HBox styleClass="header-bar" alignment="CENTER_LEFT">
        <padding>
            <Insets left="30" right="30" top="15" bottom="15"/>
        </padding>
        <HBox alignment="CENTER_LEFT" spacing="15">
            <FontAwesomeIconView glyphName="BAR_CHART" size="2em" fill="WHITE"/>
            <Label text="Admin Dashboard" styleClass="header-title"/>
        </HBox>
        <Region HBox.hgrow="ALWAYS"/>
        <HBox spacing="15" alignment="CENTER" styleClass="nav-buttons-container">
            <Button onAction="#goBackToWelcome" styleClass="nav-button">
                <graphic>
                    <FontAwesomeIconView glyphName="ARROW_LEFT" size="1.5em" fill="WHITE"/>
                </graphic>
                <tooltip>
                    <Tooltip text="Retour Ã  l'accueil" styleClass="custom-tooltip"/>
                </tooltip>
            </Button>
            <Button onAction="#openPromoAdmin" styleClass="nav-button">
                <graphic>
                    <FontAwesomeIconView glyphName="TICKET" size="1.5em" fill="WHITE"/>
                </graphic>
                <tooltip>
                    <Tooltip text="Add Promo Code" styleClass="custom-tooltip"/>
                </tooltip>
            </Button>
            <Button onAction="#handleLogout" styleClass="nav-button">
                <graphic>
                    <FontAwesomeIconView glyphName="SIGN_OUT" size="1.5em" fill="WHITE"/>
                </graphic>
                <tooltip>
                    <Tooltip text="DÃ©connexion" styleClass="custom-tooltip"/>
                </tooltip>
            </Button>
        </HBox>
    </HBox>

    <!-- Contenu principal -->
    <StackPane fx:id="contentArea" VBox.vgrow="ALWAYS" styleClass="content-area">
        <ScrollPane fitToWidth="true" styleClass="custom-scroll-pane">
            <VBox spacing="30" styleClass="dashboard-container">
                <padding>
                    <Insets top="40" right="40" bottom="40" left="40"/>
                </padding>


                <HBox spacing="25" alignment="CENTER" styleClass="cards-container">
                    <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                        <StackPane styleClass="icon-container">
                            <FontAwesomeIconView glyphName="SHOPPING_CART" size="2em"/>
                        </StackPane>
                        <Label text="Commandes Totales" styleClass="card-title"/>
                        <Label fx:id="totalOrdersLabel" styleClass="card-value" text="0"/>
                    </VBox>
                    <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                        <StackPane styleClass="icon-container">
                            <FontAwesomeIconView glyphName="HOURGLASS_HALF" size="2em"/>
                        </StackPane>
                        <Label text="En Attente" styleClass="card-title"/>
                        <Label fx:id="pendingOrdersLabel" styleClass="card-value" text="0"/>
                    </VBox>
                    <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                        <StackPane styleClass="icon-container">
                            <FontAwesomeIconView glyphName="CHECK_CIRCLE" size="2em"/>
                        </StackPane>
                        <Label text="ConfirmÃ©es" styleClass="card-title"/>
                        <Label fx:id="confirmedOrdersLabel" styleClass="card-value" text="0"/>
                    </VBox>
                </HBox>

                <!-- Nouveaux Indicateurs de Performance -->
                <HBox spacing="25" alignment="CENTER" styleClass="cards-container">
                    <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                        <StackPane styleClass="icon-container">
                            <FontAwesomeIconView glyphName="LINE_CHART" size="2em"/>
                        </StackPane>
                        <Label text="Performance du Site" styleClass="card-title"/>
                        <Label fx:id="sitePerformanceLabel" styleClass="card-value" text="99%"/>
                    </VBox>
                    <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                        <StackPane styleClass="icon-container">
                            <FontAwesomeIconView glyphName="CLOCK" size="2em"/>
                        </StackPane>
                        <Label text="Temps Moyen d'Acceptation" styleClass="card-title"/>
                        <Label fx:id="orderAcceptanceTimeLabel" styleClass="card-value" text="3 min"/>
                    </VBox>
                    <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                        <StackPane styleClass="icon-container">
                            <FontAwesomeIconView glyphName="MONEY" size="2em"/>
                        </StackPane>
                        <Label text="Revenu sur le Site" styleClass="card-title"/>
                        <Label fx:id="siteRevenuePercentageLabel" styleClass="card-value" text="65%"/>
                    </VBox>
                </HBox>
                <VBox spacing="15" styleClass="statistics-container">
                    <HBox spacing="8" alignment="CENTER_LEFT">
                        <FontAwesomeIconView glyphName="BAR_CHART" size="1.8em" fill="#4CAF50"/>
                        <Label text="Promo Code Statistics" styleClass="section-header"/>
                    </HBox>

                    <HBox spacing="50" alignment="CENTER">
                        <!-- ðŸ“Œ PieChart pour la rÃ©partition des pourcentages -->
                        <VBox alignment="CENTER">
                            <Label text="RÃ©partition des RÃ©ductions (%)" styleClass="chart-title"/>
                            <PieChart fx:id="promoDistributionChart" prefWidth="450" prefHeight="350" styleClass="styled-piechart"/>
                        </VBox>

                        <!-- ðŸ“ˆ LineChart pour les codes promo actifs par mois -->
                        <VBox alignment="CENTER">
                            <Label text="Tendance des Codes Promo Actifs" styleClass="chart-title"/>
                            <LineChart fx:id="promoTrendChart" prefWidth="600" prefHeight="350" styleClass="styled-linechart">
                                <xAxis>
                                    <CategoryAxis fx:id="promoMonthAxis" label="Mois"/>
                                </xAxis>
                                <yAxis>
                                    <NumberAxis fx:id="promoCountAxis" label="Nombre de Codes"/>
                                </yAxis>
                            </LineChart>
                        </VBox>
                    </HBox>
                </VBox>


                <!-- Graphique des commandes par statut -->
                <VBox spacing="10" styleClass="chart-container">
                    <HBox spacing="8" alignment="CENTER_LEFT">
                        <FontAwesomeIconView glyphName="LINE_CHART" size="1.8em" fill="#007BFF"/>
                        <Label text="Order Statistics" styleClass="section-header"/>
                    </HBox>

                    <BarChart fx:id="ordersByStatusChart">
                        <xAxis>
                            <CategoryAxis label="Statut"/>
                        </xAxis>
                        <yAxis>
                            <NumberAxis label="Nombre de Commandes"/>
                        </yAxis>
                    </BarChart>
                </VBox>
                <!-- Section Statistiques -->
                <HBox spacing="25" alignment="CENTER" styleClass="cards-container">
                    <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                        <StackPane styleClass="icon-container">
                            <FontAwesomeIconView glyphName="TICKET" size="2em"/>
                        </StackPane>
                        <Label text="Promo Code" styleClass="card-title"/>
                        <Button text="âž• Add Promo" onAction="#openPromoAdmin"
                                styleClass="promo-add-button"/>

                        <VBox spacing="15" styleClass="promo-container">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <FontAwesomeIconView glyphName="TAGS" size="1.8em" fill="#5A189A"/>
                                <Label text="Available Promo Codes" styleClass="section-header"/>
                            </HBox>

                            <!-- Conteneur sous forme de tableau -->
                            <FlowPane fx:id="promoGrid" hgap="20" vgap="20" styleClass="promo-grid"/>
                        </VBox>

                    </VBox>
                </HBox>
                <VBox spacing="20" styleClass="orders-section">
                    <HBox spacing="8" alignment="CENTER_LEFT">
                        <FontAwesomeIconView glyphName="LIST_ALT" size="1.8em" fill="#1E88E5"/>
                        <Label text="All Client Orders" styleClass="section-header"/>
                    </HBox>

                    <ScrollPane fitToWidth="true" fitToHeight="true" prefHeight="400" styleClass="custom-scroll-pane">
                        <VBox fx:id="ordersContainer" spacing="15" styleClass="orders-container">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                        </VBox>
                    </ScrollPane>
                </VBox>
            </VBox>
        </ScrollPane>
    </StackPane>
</VBox>
